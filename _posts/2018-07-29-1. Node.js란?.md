# Node.js

## Node.js 란?

javascript 엔진으로 빌드된 asynchronous event driven JavaScript runtime.

>  runtime(런타임): 프로그래밍 언어가 구동되는 환경



## 비동기 처리

- async/await
- promise
- generator



Node.js v7.6부터 async/await 지원 시작.

async/await를 통해서 **callback hell**을 방지할 수 있음.



[![Hell, Programmer Humor, and Javascript: ES7  Promise  Async  Await  ES6  Promise  ES5  Callback Hell Async JavaScript](https://pics.me.me/es7-promise-async-await-es6-promise-es5-callback-hell-async-27790051.png)](javascript:void(0))



#### callback hell이란?

```javascript
function1(function(input, result1) {
  function2(function(result2) {
    function3(function(result3) {
      function4(function(result4) {
        function5(function(output) {
            // finally, do something...
        });
      });
    });
  });
});
```



```javascript
const verifyUser = function(username, password, callback){
   dataBase.verifyUser(username, password, (error, userInfo) => {
       if (error) {
           callback(error)
       }else{
           dataBase.getRoles(username, (error, roles) => {
               if (error){
                   callback(error)
               }else {
                   dataBase.logAccess(username, (error) => {
                       if (error){
                           callback(error);
                       }else{
                           callback(null, userInfo, roles);
                       }
                   })
               }
           })
       }
   })
};
```



#### async/await를 사용하면?

```javascript
const verifyUser = async function(username, password){
   try {
       const userInfo = await dataBase.verifyUser(username, password);
       const rolesInfo = await dataBase.getRoles(userInfo);
       const logStatus = await dataBase.logAccess(userInfo);
       return userInfo;
   }catch (e){
       //handle errors as needed
   }
};
```

> 코드가 간결해지고 가독성이 높아진 것을 볼 수 있다.



#### async/await 사용법

function 앞에 async를 붙여주고 그 안에 있는 호출할 비동기 함수 앞에 await를 붙여주면 된다.

```javascript
async function test() {
    await foo(a,b)
}

//arrow function
let test = async () => {
    await foo(a,b)
}
```



[예제코드 참조한 곳 링크](https://www.toptal.com/javascript/asynchronous-javascript-async-await-tutorial) 





## Express

Node.js에서 가장 보편적으로 사용되고 있는 프레임워크.

MVC 형태의 구조 제공.



## Middleware

응용 소프트웨어가 운영체제로부터 제공받는 서비스 이외에 추가적으로 이용할 수 있는 서비스를 제공하는 소프트웨어.



#### Node에서 보편적으로 사용하는 미들웨어

- Body parser 
  - 클라이언트가 POST요청을 할 때 데이터를 쉽게 추출할 수 있도록하는 미들웨어.
  - request에 body 속성을 부여 
  - ex) `req.body.id`
- Passport
  - 인증 관련 미들웨어
  - session 관리

